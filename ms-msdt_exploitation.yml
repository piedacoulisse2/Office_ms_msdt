title: ms-msdt for RCE  
description: Exploit the execution of weaponized maldoc or embedded link in outlook that uses ms-msdt scheme to execute code.
status: experimental
references:
  - https://twitter.com/nao_sec/status/1530196847679401984
  - https://doublepulsar.com/follina-a-microsoft-office-code-execution-vulnerability-1a47fce5629e
  - https://twitter.com/DidierStevens/status/1531033449561264128
  - https://twitter.com/_JohnHammond/status/1531148551392268288
author: 'piedacoulisse'
date: 2022/05/30
logsource:
    category: process_creation
    product: windows
detection:
    selection1:
        ParentImage|endswith:
          - '\excel.exe'
          - '\winword.exe'
          - '\outlook.exe'
        Image|endswith:
          - '\msdt.exe'
        CommandLine|contains|all:
          - 'ms-msdt:/id'
          - 'IT_BrowseForFile'
          - 'IT_LaunchMethod'
    condition: selection1
falsepositives:
    - Uknown
level: high
tags:
    - attack.execution
    - attack.T1059.003
    - attack.T1204.002